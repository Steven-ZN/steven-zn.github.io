<meta charset="utf-8">

{% if site.seo_title %}
  <title>{{ site.seo_title }}</title>
{% elsif page.title %}
  <title>{{ page.title }} - {{ site.title }}</title>
{% else %}
  <title>{{ site.title }}</title>
{% endif %}

<meta name="description" content="{{ page.excerpt | default: site.description | strip_html | normalize_whitespace | truncate: 160 | escape }}">

<meta name="author" content="{{ site.author.name | default: site.author }}">

<meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
<meta property="og:locale" content="{{ site.locale | replace: '-', '_' | default: 'en_US' }}">
<meta property="og:site_name" content="{{ site.title }}">
<meta property="og:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}">
<meta property="og:url" content="{{ canonical_url }}">

{% if site.social.name %}
  <meta property="og:image" content="{% if page.header.image %}{{ page.header.image | absolute_url }}{% else %}{{ site.og_image | absolute_url }}{% endif %}">
{% endif %}

{% if page.date %}
  <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
{% endif %}

{% if og_image %}
  <meta property="og:image" content="{{ og_image }}">
{% endif %}

{% if page.excerpt %}
  <meta property="og:description" content="{{ page.excerpt | strip_html | normalize_whitespace | truncate: 160 | escape }}">
{% endif %}

<!-- Font Awesome Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="{{ '/images/favicon.svg' | relative_url }}">
<link rel="shortcut icon" href="{{ '/images/favicon.svg' | relative_url }}">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

{% seo %}

<link href="{% if jekyll.environment == 'production' %}{{ '/assets/css/main.css' | absolute_url }}{% else %}{{ '/assets/css/main.css' | relative_url }}{% endif %}" rel="stylesheet">

<!-- Dark Mode Toggle Button -->
<div class="dark-mode-toggle" onclick="toggleDarkMode()">
  <i class="fas fa-sun toggle-icon sun" id="sun-icon"></i>
  <i class="fas fa-moon toggle-icon moon" id="moon-icon" style="display: none;"></i>
</div>

<!-- Dark Mode JavaScript -->
<script>
// Check for saved theme preference or default to light mode
const currentTheme = localStorage.getItem('theme') || 'light';
document.documentElement.setAttribute('data-theme', currentTheme);

// Update toggle button display
function updateToggleButton() {
  const sunIcon = document.getElementById('sun-icon');
  const moonIcon = document.getElementById('moon-icon');
  const currentTheme = document.documentElement.getAttribute('data-theme');
  
  if (currentTheme === 'dark') {
    sunIcon.style.display = 'block';
    moonIcon.style.display = 'none';
  } else {
    sunIcon.style.display = 'none';
    moonIcon.style.display = 'block';
  }
}

// Toggle dark mode function
function toggleDarkMode() {
  const currentTheme = document.documentElement.getAttribute('data-theme');
  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
  
  document.documentElement.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
  updateToggleButton();
}

// Initialize button on page load
document.addEventListener('DOMContentLoaded', updateToggleButton);
</script>

<!-- 搜索和返回顶部功能 -->
<script src="{{ '/assets/js/search.js' | relative_url }}" defer></script>

<!-- GitHub仓库访问统计 - 每次访问自动更新TXT文件 -->
<script src="{{ '/assets/js/github-analytics.js' | relative_url }}" defer></script>


{% if site.head_scripts %}
  {% for script in site.head_scripts %}
    <script src="{{ script | relative_url }}"></script>
  {% endfor %}
{% endif %}